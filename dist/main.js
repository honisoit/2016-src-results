var pymChild=new pym.Child,sheetURL="https://docs.google.com/spreadsheets/d/1YrPVj8O8ZrZaByz8wMhS56N8rL7e2hK-in_cyWlrq4I/pubhtml",rawData={},constants={presMantlePercentage:"50%",presBrookPercentage:"50%"},updatesData={},presData=[{booth:"Pre-poll",brook:null,brookPercentage:"-",mantle:null,mantlePercentage:"-",informal:null,informalPercentage:"-",total:0},{booth:"JFR",brook:null,brookPercentage:"-",mantle:null,mantlePercentage:"-",informal:null,informalPercentage:"-",total:0},{booth:"Fisher",brook:null,brookPercentage:"-",mantle:null,mantlePercentage:"-",informal:null,informalPercentage:"-",total:0},{booth:"Manning",brook:null,brookPercentage:"-",mantle:null,mantlePercentage:"-",informal:null,informalPercentage:"-",total:0},{booth:"Cumberland",brook:null,brookPercentage:"-",mantle:null,mantlePercentage:"-",informal:null,informalPercentage:"-",total:0},{booth:"Engineering",brook:null,brookPercentage:"-",mantle:null,mantlePercentage:"-",informal:null,informalPercentage:"-",total:0},{booth:"SCA",brook:null,brookPercentage:"-",mantle:null,mantlePercentage:"-",informal:null,informalPercentage:"-",total:0},{booth:"The Con",brook:null,brookPercentage:"-",mantle:null,mantlePercentage:"-",informal:null,informalPercentage:"-",total:0},{booth:"Declaration",brook:null,brookPercentage:"-",mantle:null,mantlePercentage:"-",informal:null,informalPercentage:"-",total:0},{booth:"Postal",brook:null,brookPercentage:"-",mantle:null,mantlePercentage:"-",informal:null,informalPercentage:"-",total:0},{booth:"Total",brook:0,brookPercentage:"-",mantle:0,mantlePercentage:"-",informal:0,informalPercentage:"-",total:0}],honiData=[{name:"Time",primaryVote:500,preferenceVote:-500,finalVote:0,colorPreferences:"#ffcc33",colorPrimary:"#ffcc33"},{name:"Wet",primaryVote:600,preferenceVote:400,finalVote:1e3,colorPreferences:"#ffcc33",colorPrimary:"#99cccc"},{name:"Sin",primaryVote:700,preferenceVote:100,finalVote:800,colorPreferences:"#ffcc33",colorPrimary:"#cc99ff"},{name:"Informal",primaryVote:50,preferenceVote:0,finalVote:50,colorPreferences:"#ffcc33",colorPrimary:"#999"}],tabletopInit=function(){Tabletop.init({key:sheetURL,callback:processData,simpleSheet:!1})},processData=function(e,t){rawData=e,constants=e.constants.elements[0],updatesData=e.updates.elements,updatesData=updatesData.reverse(),presData=e.pres.elements,honiPrimaryData=e.honiprimary.elements,honiPreferenceData=e.honipreferences.elements,honiTotalsData=e.honitotals.elements,update()},copyUpdate=function(){d3.select(".js-header-title").text(constants.title),d3.select(".js-header-standfirst").html(constants.headerStandfirst),d3.select(".js-footer-footnotes").html(constants.footnotes),d3.select(".js-pres-turnout").text(constants.presTurnout),d3.select(".js-pres-booths").text(constants.presBoothsCounted+"/"+constants.numberOfBooths),d3.select(".js-pres-standfirst").html(constants.presStandfirst),d3.select(".js-pres-footnotes").html(constants.presFootnotes),d3.select(".js-honi-turnout").text(constants.honiTurnout),d3.select(".js-honi-booths").text(constants.honiBoothsCounted+"/"+constants.numberOfBooths),d3.select(".js-honi-standfirst").html(constants.honiStandfirst),d3.select(".js-honi-footnotes").html(constants.honiFootnotes),d3.select(".js-honi-primary-analysis").html(constants.honiPrimaryAnalysis),d3.select(".js-honi-preference-analysis").html(constants.honiPreferenceAnalysis)},presWinningPercentage=48,presSummaryHeight=40,presSummaryLabelPadding=15,presSummary=d3.select(".js-pres-summary").append("svg"),presSummarySegmentOne=presSummary.append("rect"),presSummarySegmentTwo=presSummary.append("rect"),presSummaryMidline=presSummary.append("line"),presSummaryLabelOne=presSummary.append("text"),presSummaryLabelTwo=presSummary.append("text"),presSummaryInit=function(){var e=$(".js-content-results").width(),t=parseInt(constants.presMantlePercentage)/100;presSummary.attr("height",presSummaryHeight).attr("width",e),presSummarySegmentOne.attr("x",0).attr("y",0).attr("width",t*e).attr("height",presSummaryHeight).style("fill","#008938"),presSummarySegmentTwo.attr("x",t*e).attr("y",0).attr("width",t*e).attr("height",presSummaryHeight).style("fill","#753da6"),presSummaryMidline.attr("x1",e/2).attr("y1",0).attr("x2",e/2).attr("y2",presSummaryHeight).attr("stroke-width",2).attr("stroke","black"),presSummaryLabelOne.attr("x",presSummaryLabelPadding).attr("y",presSummaryHeight/4).attr("dy",presSummaryHeight/2).classed("pres__summary-segment-label",!0).text(constants.presMantlePercentage),presSummaryLabelTwo.attr("x",e-presSummaryLabelPadding).attr("y",presSummaryHeight/4).attr("dy",presSummaryHeight/2).attr("text-anchor","end").classed("pres__summary-segment-label",!0).text(constants.presBrookPercentage)},presSummaryUpdate=function(){var e=$(".js-content-results").width(),t=parseInt(constants.presMantlePercentage)/100;presSummary.attr("width",e),presSummarySegmentOne.transition().attr("width",e*t),presSummarySegmentTwo.transition().attr("x",e*t).attr("width",(1-t)*e),presSummaryMidline.attr("x1",e/2).attr("x2",e/2),presSummaryLabelOne.text(constants.presMantlePercentage),presSummaryLabelTwo.attr("x",e-presSummaryLabelPadding).text(constants.presBrookPercentage)},presTableUpdate=function(){var e=(d3.select(".js-pres-table").html(""),d3.select(".js-pres-table").append("table").classed("table",!0)),t=(e.append("tr").classed("table__header",!0).selectAll("td").data(["Booth","Brook","%","Mantle","%","Informal","%","Total"]).enter().append("td").text(function(e){return e}),e.selectAll("tr").data(presData).enter().append("tr").classed("table__row",!0));t.selectAll("td").data(function(e){return d3.values(e)}).enter().append("td").text(function(e){return e})},honiSummaryNumberOfTickets=4,honiSummaryRowHeight=30,honiSummaryRowSpace=4,honiSummaryTopPad=14,honiSummaryHeight=honiSummaryNumberOfTickets*honiSummaryRowHeight*2+(honiSummaryNumberOfTickets-1)*honiSummaryRowSpace+honiSummaryTopPad,honiSummaryWidth=$(".js-honi-summary").width(),honiPrimary=d3.select(".js-honi-primary").append("svg"),honiPrimaryMidline=honiPrimary.append("line"),honiPrimaryHeight=7.6*honiSummaryRowHeight,honiPrimaryInit=function(){var e=$(".js-content-results").width();honiPrimary.attr("height",honiPrimaryHeight).attr("width",e);var t=honiPrimary.selectAll("g").data([{name:"TIME",percentage:"38.43%",multiplier:.3843,hex:"#fbd75d"},{name:"WET",percentage:"32.73%",multiplier:.3273,hex:"#6dcff6"},{name:"SIN",percentage:"27.00%",multiplier:.27,hex:"#bd8cbf"},{name:"Informal",percentage:"3.28%",multiplier:.0328,hex:"#b3b3aa"}]).enter().append("g").attr("transform",function(e,t){return"translate(0,"+(honiSummaryTopPad+t*honiSummaryRowHeight*2)+")"});t.append("text").text(function(e,t){return e.name+" – "+e.percentage}).classed("honi__ticket-label",!0),t.append("rect").attr("height",honiSummaryRowHeight).attr("width",function(t,a){return t.multiplier*e}).attr("transform",function(){return"translate(0,"+honiSummaryRowSpace+")"}).attr("fill",function(e,t){return e.hex});honiPrimaryMidline.attr("x1",e/2).attr("y1",0).attr("x2",e/2).attr("y2",honiSummaryHeight).attr("stroke-width",2).attr("stroke","black")},honiPreferences=d3.select(".js-honi-preferences").append("svg"),honiPreferencesMidline=honiPreferences.append("line"),honiPreferencesInit=function(){var e=$(".js-content-results").width();honiPreferences.attr("height",4*honiSummaryRowHeight).attr("width",e);var t=honiPreferences.selectAll("g").data([{name:"WET",percentage:"53.97%",multiplier:.5397,hex:"#6dcff6"},{name:"TIME",percentage:"46.03%",multiplier:.4603,hex:"#fbd75d"}]).enter().append("g").attr("transform",function(e,t){return"translate(0,"+(honiSummaryTopPad+t*honiSummaryRowHeight*2)+")"});t.append("text").text(function(e,t){return e.name+" – "+e.percentage}).classed("honi__ticket-label",!0),t.append("rect").attr("height",honiSummaryRowHeight).attr("width",function(t,a){return t.multiplier*e}).attr("transform",function(){return"translate(0,"+honiSummaryRowSpace+")"}).attr("fill",function(e,t){return e.hex});honiPreferencesMidline.attr("x1",e/2).attr("y1",0).attr("x2",e/2).attr("y2",honiSummaryHeight).attr("stroke-width",2).attr("stroke","black")},honiPrimaryTableUpdate=function(){var e=(d3.select(".js-honi-primary-table").html(""),d3.select(".js-honi-primary-table").append("table").classed("table",!0)),t=(e.append("tr").classed("table__header",!0).selectAll("td").data(["Booth","TIME","%","WET","%","SIN","%","Informal","%","Total"]).enter().append("td").text(function(e){return e}),e.selectAll("tr").data(honiPrimaryData).enter().append("tr").classed("table__row",!0));t.selectAll("td").data(function(e){return d3.values(e)}).enter().append("td").text(function(e){return e})},honiPreferenceTableUpdate=function(){var e=(d3.select(".js-honi-preferences-table").html(""),d3.select(".js-honi-preferences-table").append("table").classed("table",!0)),t=(e.append("tr").classed("table__header",!0).selectAll("td").data(["Booth","TIME","%","WET","%","Exhausted","%","Total"]).enter().append("td").text(function(e){return e}),e.selectAll("tr").data(honiPreferenceData).enter().append("tr").classed("table__row",!0));t.selectAll("td").data(function(e){return d3.values(e)}).enter().append("td").text(function(e){return e})},honiTotalsTableUpdate=function(){var e=(d3.select(".js-honi-totals-table").html(""),d3.select(".js-honi-totals-table").append("table").classed("table",!0)),t=(e.append("tr").classed("table__header",!0).selectAll("td").data(["Booth","TIME","%","WET","%","Total"]).enter().append("td").text(function(e){return e}),e.selectAll("tr").data(honiTotalsData).enter().append("tr").classed("table__row",!0));t.selectAll("td").data(function(e){return d3.values(e)}).enter().append("td").text(function(e){return e})},updatesUpdate=function(){var e=d3.select(".js-updates-entries");e.html("");var t=e.selectAll("article").data(updatesData).enter().append("article").classed("updates__entry",!0);t.append("h5").classed("updates__heading",!0).text(function(e,t){return updatesData[t].heading}),t.append("p").classed("updates__meta",!0).text(function(e,t){return updatesData[t].meta}),t.append("div").classed("updates__body",!0).html(function(e,t){return updatesData[t].body})},tabsInit=function(){$("ul.tabs li").click(function(){var e=$(this).attr("data-tab");$("ul.tabs li").removeClass("tabs__tab--current"),$(".tabs__content").removeClass("tabs__content--current"),$(this).addClass("tabs__tab--current"),$("#"+e).addClass("tabs__content--current"),pymChild.sendHeight()})};$(window).resize(function(){update()});var init=function(){tabsInit(),presSummaryInit(),presTableUpdate(),honiPrimaryInit(),honiPreferencesInit(),tabletopInit(),pymChild.sendHeight()},update=function(){presSummaryUpdate(),presTableUpdate(),honiPrimaryTableUpdate(),honiPreferenceTableUpdate(),honiTotalsTableUpdate(),updatesUpdate(),copyUpdate(),pymChild.sendHeight()};$(document).ready(function(){init()});